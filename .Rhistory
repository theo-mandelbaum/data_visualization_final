knitr::opts_chunk$set(
collapse = TRUE,
message = FALSE
)
library(tidyverse)
library(here)
chronic_diseases <- read.csv(here("../U.S._Chronic_Disease_Indicators.csv"))
knitr::opts_chunk$set(
collapse = TRUE,
message = FALSE
)
library(tidyverse)
library(here)
library(dplyr)
chronic_diseases <- read.csv(here("../U.S._Chronic_Disease_Indicators.csv"))
knitr::opts_chunk$set(
collapse = TRUE,
message = FALSE
)
library(tidyverse)
library(here)
library(dplyr)
library(readxl)
chronic_diseases <- read.csv(here("data/U.S._Chronic_Disease_Indicators.csv"))
knitr::opts_chunk$set(
collapse = TRUE,
message = FALSE
)
library(tidyverse)
library(here)
library(dplyr)
library(readxl)
chronic_diseases <- read.csv(here("data/U.S._Chronic_Disease_Indicators.csv"))
knitr::opts_chunk$set(
collapse = TRUE,
message = FALSE
)
library(tidyverse)
library(here)
library(dplyr)
library(readxl)
chronic_diseases <- read.csv(here("data/U.S._Chronic_Disease_Indicators.csv"))
air_quality_2015 <- read.csv(here("data/annual_aqi_by_county_2015.csv"))
knitr::opts_chunk$set(
collapse = TRUE,
message = FALSE
)
library(tidyverse)
library(here)
library(dplyr)
library(readxl)
chronic_diseases <- read.csv(here("data/U.S._Chronic_Disease_Indicators.csv"))
air_quality_2015 <- read.csv(here("data/annual_aqi_by_county_2015.csv"))
air_quality_2016 <- read.csv(here("data/annual_aqi_by_county_2016.csv"))
air_quality_2017 <- read.csv(here("data/annual_aqi_by_county_2017.csv"))
air_quality_2018 <- read.csv(here("data/annual_aqi_by_county_2018.csv"))
air_quality_2019 <- read.csv(here("data/annual_aqi_by_county_2019.csv"))
air_quality_2020 <- read.csv(here("data/annual_aqi_by_county_2020.csv"))
air_quality_2021 <- read.csv(here("data/annual_aqi_by_county_2021.csv"))
population_data <- read_excel(here("data/co-est2020int-pop.xlsx"), skip=3)
library(tidyverse)
library(here)
library(dplyr)
library(readxl)
chronic_diseases <- read.csv(here("data/U.S._Chronic_Disease_Indicators.csv"))
air_quality_2015 <- read.csv(here("data/annual_aqi_by_county_2015.csv"))
air_quality_2016 <- read.csv(here("data/annual_aqi_by_county_2016.csv"))
air_quality_2017 <- read.csv(here("data/annual_aqi_by_county_2017.csv"))
air_quality_2018 <- read.csv(here("data/annual_aqi_by_county_2018.csv"))
air_quality_2019 <- read.csv(here("data/annual_aqi_by_county_2019.csv"))
air_quality_2020 <- read.csv(here("data/annual_aqi_by_county_2020.csv"))
air_quality_2021 <- read.csv(here("data/annual_aqi_by_county_2021.csv"))
population_data <- read_excel(here("data/co-est2020int-pop.xlsx"), skip=3)
knitr::opts_chunk$set(
collapse = TRUE,
message = FALSE
)
library(tidyverse)
library(here)
library(dplyr)
library(readxl)
chronic_diseases <- read.csv(here("data/U.S._Chronic_Disease_Indicators.csv"))
air_quality_2015 <- read.csv(here("data/annual_aqi_by_county_2015.csv"))
air_quality_2016 <- read.csv(here("data/annual_aqi_by_county_2016.csv"))
air_quality_2017 <- read.csv(here("data/annual_aqi_by_county_2017.csv"))
air_quality_2018 <- read.csv(here("data/annual_aqi_by_county_2018.csv"))
air_quality_2019 <- read.csv(here("data/annual_aqi_by_county_2019.csv"))
air_quality_2020 <- read.csv(here("data/annual_aqi_by_county_2020.csv"))
air_quality_2021 <- read.csv(here("data/annual_aqi_by_county_2021.csv"))
population_data <- read_excel(here("data/co-est2020int-pop.xlsx"), skip=3)
unique_topics <- unique(chronic_diseases$Topic)
print(unique_topics)
chronic_diseases %>%
filter(Topic == "Cancer") %>%
pull(Question) %>%
unique()
chronic_diseases %>%
filter(Topic == "Tobacco") %>%
pull(Question) %>%
unique()
chronic_diseases %>%
filter(Topic == "Sleep") %>%
pull(Question) %>%
unique()
chronic_diseases %>%
filter(Topic == "Nutrition, Physical Activity, and Weight Status") %>%
pull(Question) %>%
unique()
respiratory_diseases <- chronic_diseases %>%
filter(
Topic %in% c("Asthma", "Cancer", "Tobacco", "Nutrition, Physical Activity, and Weight Status") &
(
(Topic == "Cancer" & Question == "Lung and bronchial cancer mortality among all people, underlying cause") |
(Topic == "Tobacco" & Question %in% c(
"Quit attempts in the past year among adult current smokers",
"Current cigarette smoking among adults",
"Cigarette smoking during pregnancy among women with a recent live birth",
"Current electronic vapor product use among high school students"
)) |
(Topic == "Nutrition, Physical Activity, and Weight Status" & Question %in% c(
"Children and adolescents aged 6-13 years meeting aerobic physical activity guideline",
"Met aerobic physical activity guideline among high school students",
"Met aerobic physical activity guideline for substantial health benefits, adults"
)) |
(Topic == "Asthma") |
(Topic == "Chronic Obstructive Pulmonary Disease")
)
)
population_data_cleaned <- population_data %>%
select(1, 8:ncol(.)) %>%
setNames(c("Name", paste0(2015:2020)))
air_quality_all <- bind_rows(
air_quality_2015,
air_quality_2016,
air_quality_2017,
air_quality_2018,
air_quality_2019,
air_quality_2020
)
# Modify population data for easy joining with AQI
population_long <- population_data_cleaned %>%
filter(str_detect(Name, "County")) %>% # get just the counties, not the US one
pivot_longer(
cols = starts_with("20"), # get just the years
names_to = "Year",
values_to = "Population"
) %>%
mutate(Year = as.integer(Year)) %>%
separate(Name, into = c("County", "State"), sep = ",\\s*") # split at the comma
# Group Air Quality by State
aqi_state <- air_quality_all %>%
group_by(State, Year) %>%
summarise(AQI = mean(Max.AQI, na.rm = TRUE))
scatter_data <- population_long %>%
left_join(aqi_state, by = c("State", "Year")) %>%
filter(!is.na(AQI) & !is.na(Population))
ggplot(scatter_data, aes(x = Population, y = AQI, color = factor(Year))) +
geom_point(alpha = 0.6) +
scale_x_continuous(labels = scales::comma) +
labs(
title = "County Population vs Average Max AQI (2015-2020)",
x = "County Population",
y = "Average Max AQI",
color = "Year"
)
state_lookup <- tibble(
State = state.name,
LocationAbbr = state.abb
)
aqi_state <- aqi_state %>%
left_join(state_lookup, by = c("State" = "State")) %>%
select(LocationAbbr, Year, AQI)
#
respiratory_state <- respiratory_diseases %>%
filter(!is.na(DataValue)) %>%
group_by(LocationAbbr, Year = YearStart) %>%
summarise(
DiseaseRate = mean(DataValue, na.rm = TRUE),
)
scatter_data_2 <- aqi_state %>%
left_join(respiratory_state, by = c("LocationAbbr", "Year")) %>%
filter(!is.na(DiseaseRate))
ggplot(scatter_data_2, aes(x = AQI, y = DiseaseRate, color = factor(Year))) +
geom_point(alpha = 0.7, size = 3) +
labs(
title = "Correlation of AQI with Respiratory Disease Rates",
x = "Average Max AQI",
y = "Respiratory Disease Rate",
color = "Year"
)
ggplot(scatter_data,
aes(x = factor(Year), y = Population, color = AQI)) +
geom_point(alpha = 0.6) +
scale_x_continuous(labels = scales::comma) +
labs(
title = "County Population vs Average Max AQI (2015-2020)",
x = "County Population",
y = "Average Max AQI",
color = "Year"
)
ggplot(scatter_data,
aes(x = Year, y = Population, color = AQI)) +
geom_point(alpha = 0.6) +
scale_x_continuous(labels = scales::comma) +
labs(
title = "County Population vs Average Max AQI (2015-2020)",
x = "County Population",
y = "Average Max AQI",
color = "Year"
)
ggplot(scatter_data,
aes(x = Year, y = Population, color = AQI)) +
geom_point(alpha = 0.6) +
scale_x_continuous(labels = scales::comma)
ggplot(scatter_data,
aes(x = Year, y = Population, color = AQI)) +
geom_line(alpha = 0.6) +
scale_x_continuous(labels = scales::comma)
ggplot(scatter_data,
aes(x = Year, y = Population)) +
geom_line(alpha = 0.6) +
scale_x_continuous(labels = scales::comma)
ggplot(scatter_data,
aes(x = Year, y = Population)) +
geom_line(alpha = 0.6)
View(scatter_data)
View(scatter_data_2)
ggplot(scatter_data_2,
aes(x = Year, y = Population)) +
geom_line()
knitr::opts_chunk$set(
collapse = TRUE,
message = FALSE
)
library(tidyverse)
library(here)
library(dplyr)
library(readxl)
chronic_diseases <- read.csv(here("data/U.S._Chronic_Disease_Indicators.csv"))
air_quality_2015 <- read.csv(here("data/annual_aqi_by_county_2015.csv"))
air_quality_2016 <- read.csv(here("data/annual_aqi_by_county_2016.csv"))
air_quality_2017 <- read.csv(here("data/annual_aqi_by_county_2017.csv"))
air_quality_2018 <- read.csv(here("data/annual_aqi_by_county_2018.csv"))
air_quality_2019 <- read.csv(here("data/annual_aqi_by_county_2019.csv"))
air_quality_2020 <- read.csv(here("data/annual_aqi_by_county_2020.csv"))
air_quality_2021 <- read.csv(here("data/annual_aqi_by_county_2021.csv"))
population_data <- read_excel(here("data/co-est2020int-pop.xlsx"), skip=3)
unique_topics <- unique(chronic_diseases$Topic)
print(unique_topics)
chronic_diseases %>%
filter(Topic == "Cancer") %>%
pull(Question) %>%
unique()
chronic_diseases %>%
filter(Topic == "Tobacco") %>%
pull(Question) %>%
unique()
chronic_diseases %>%
filter(Topic == "Sleep") %>%
pull(Question) %>%
unique()
chronic_diseases %>%
filter(Topic == "Nutrition, Physical Activity, and Weight Status") %>%
pull(Question) %>%
unique()
respiratory_diseases <- chronic_diseases %>%
filter(
Topic %in% c("Asthma", "Cancer", "Tobacco", "Nutrition, Physical Activity, and Weight Status") &
(
(Topic == "Cancer" & Question == "Lung and bronchial cancer mortality among all people, underlying cause") |
(Topic == "Tobacco" & Question %in% c(
"Quit attempts in the past year among adult current smokers",
"Current cigarette smoking among adults",
"Cigarette smoking during pregnancy among women with a recent live birth",
"Current electronic vapor product use among high school students"
)) |
(Topic == "Nutrition, Physical Activity, and Weight Status" & Question %in% c(
"Children and adolescents aged 6-13 years meeting aerobic physical activity guideline",
"Met aerobic physical activity guideline among high school students",
"Met aerobic physical activity guideline for substantial health benefits, adults"
)) |
(Topic == "Asthma") |
(Topic == "Chronic Obstructive Pulmonary Disease")
)
)
population_data_cleaned <- population_data %>%
select(1, 8:ncol(.)) %>%
setNames(c("Name", paste0(2015:2020)))
air_quality_all <- bind_rows(
air_quality_2015,
air_quality_2016,
air_quality_2017,
air_quality_2018,
air_quality_2019,
air_quality_2020
)
# Modify population data for easy joining with AQI
population_long <- population_data_cleaned %>%
filter(str_detect(Name, "County")) %>% # get just the counties, not the US one
pivot_longer(
cols = starts_with("20"), # get just the years
names_to = "Year",
values_to = "Population"
) %>%
mutate(Year = as.integer(Year)) %>%
separate(Name, into = c("County", "State"), sep = ",\\s*") # split at the comma
# Group Air Quality by State
aqi_state <- air_quality_all %>%
group_by(State, Year) %>%
summarise(AQI = mean(Max.AQI, na.rm = TRUE))
scatter_data <- population_long %>%
left_join(aqi_state, by = c("State", "Year")) %>%
filter(!is.na(AQI) & !is.na(Population))
ggplot(scatter_data, aes(x = Population, y = AQI, color = factor(Year))) +
geom_point(alpha = 0.6) +
scale_x_continuous(labels = scales::comma) +
labs(
title = "County Population vs Average Max AQI (2015-2020)",
x = "County Population",
y = "Average Max AQI",
color = "Year"
)
ggplot(scatter_data,
aes(x = Year, y = Population)) +
geom_line(alpha = 0.6) +
scale_x_continuous(labels = scales::comma)
state_lookup <- tibble(
State = state.name,
LocationAbbr = state.abb
)
aqi_state <- aqi_state %>%
left_join(state_lookup, by = c("State" = "State")) %>%
select(LocationAbbr, Year, AQI)
#
respiratory_state <- respiratory_diseases %>%
filter(!is.na(DataValue)) %>%
group_by(LocationAbbr, Year = YearStart) %>%
summarise(
DiseaseRate = mean(DataValue, na.rm = TRUE),
)
scatter_data_2 <- aqi_state %>%
left_join(respiratory_state, by = c("LocationAbbr", "Year")) %>%
filter(!is.na(DiseaseRate))
ggplot(scatter_data_2, aes(x = AQI, y = DiseaseRate, color = factor(Year))) +
geom_point(alpha = 0.7, size = 3) +
labs(
title = "Correlation of AQI with Respiratory Disease Rates",
x = "Average Max AQI",
y = "Respiratory Disease Rate",
color = "Year"
)
View(air_quality_all)
View(chronic_diseases)
View(population_long)
View(chronic_diseases)
View(scatter_data_2)
View(chronic_diseases)
View(respiratory_state)
View(respiratory_diseases)
View(respiratory_diseases)
View(aqi_state)
View(air_quality_all)
